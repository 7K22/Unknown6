# Decompiled Subs

This directory contains various decompiled subs that are involved
in the Unknown6 computation.

## General Structure

The main entry point, probably called from the client app code,
is **sub_564C8**.  It receives an object *(precise format unknown)*
containing various information
(like sensor and location data) as a parameter.  Its main task is
probably to compose the on-wire message, but for us the two interesting
parts of this subroutine are:

  * Creation of the input buffer (which is a serialization of
    **Signature.proto** protobuf? i.e. the Unknown6)

  * Signature computation for the input buffer (**already reverse
    engineered and available as libencrypt**).

| Sub Name      | Details |
|---------------|---------|
| sub_564C8     | Main function, no XREFs, only in a VFTable |
| sub_56B28     | calls sub_564C8 (nothing else)  
|---------------|---------|

### Input Buffer Creation

Various variables reference pieces of the parameter object in 564C8,
most prominently v26.

Some kind of first pass of Signature computation happens in sub_3FE3C(),
which stores the final serialized length to v32 (of 564C8).  The actual
serialization happens in sub_41618() which stores the serialized buffer
to *v35.  (Note the *, aka v35[0] - the other array fields are something
else!)

| Sub Name      | Details |
|---------------|---------|
| sub_3FE3C     |         |
| sub_11525C    | Called in sub_3FE3C    |
| sub_115284    | Called in sub_3FE3C    |
| sub_3EAAC     | Called in sub_3FE3C    |
| sub_3E8B0     | Called in sub_3FE3C    |
| sub_3F480     | Called in sub_3FE3C    |
| sub_3F7E4     | Called in sub_3FE3C    |
| sub_3F584     | Called in sub_3FE3C    |
| sub_3F694     | Called in sub_3FE3C    |
|---------------|---------|
| sub_41618     |         |
| sub_401D8     | Called in sub_41618, may be protobuf autogenerated code or part of the library    |
| sub_413C4     | Called in sub_41618, may be protobuf autogenerated code or part of the library        |
| sub_403E0     | Called in sub_41615, may be protobuf autogenerated code or part of the library            |
| sub_40870     | Called in sub_41616, may be protobuf autogenerated code or part of the library            |
| sub_40640     | Called in sub_41617, may be protobuf autogenerated code or part of the library            |
| sub_4059C     | Called in sub_41618, may be protobuf autogenerated code or part of the library            |

Some of the routines may be parts of the protobuf library.

| Sub Name      | Details |
|---------------|---------|
| sub_1152FC    | Common service routine, called from many places |
| sub_114D9C    | Common service routine, called from many places |
| sub_110830    | Common service routine, called from many places |

sub_110830 has a lot of further dependencies:

| Sub Name      | Details |
|---------------|---------|
| sub_11AA8C    | |
| sub_11AA98    | |
| sub_11AAC8    | |
| sub_11AB78    | |
| sub_11ABC0    | |
| sub_11ABD0    | |
| sub_11AC24    | |
| sub_11AC40    | |
| sub_11AC8C    | |
| sub_11ACA4    | |
| sub_11ACE4    | |
| sub_11B044    | |
| sub_11B094    | |
| sub_11B678    | |
| sub_11B8B4    | |
| sub_11B9B4    | |
| sub_11B9DC    | |
| sub_11BB2C    | |
| sub_11BBB4    | |
| sub_11D04C    | |
| sub_11D1C4    | |
| sub_11D268    | |
| sub_19B6C4    | |
| sub_1ABEE0    | |
| sub_1ABF04    | |
| sub_1B6F2C    | |
| sub_1B6FC0    | |
| sub_1B7044    | |
| sub_1B7AAC    | |
| sub_1B7D04    | |
| sub_1B8200    | |
| sub_1B8250    | |
| sub_1B82C8    | |
| sub_1B83E4    | |
| sub_1B85C0    | |
| sub_1B8850    | |


### Signature Computation

See ../c_code/encrypt.c for an already working amalgamation of these.

| Sub Name      | Details |
|---------------|---------|
| sub_87444     | Called from 564C8       |
| sub_9E9D8     | Called from 87444, has a main loop that calls functions from table at off_1F7060        |
| sub_87568+1   | Function table called from 9E9D8        |
| sub_8930C+1   | Function table called from 9E9D8        |
| sub_8B2F4+1   | Function table called from 9E9D8        |
| sub_8D114+1   | Function table called from 9E9D8        |
| sub_8F0B0+1   | Function table called from 9E9D8        |
| sub_910A8+1   | Function table called from 9E9D8        |
| sub_92E08+1   | Function table called from 9E9D8        |
| sub_94BDC+1   | Function table called from 9E9D8        |
| sub_96984+1   | Function table called from 9E9D8        |
| sub_985E0+1   | Function table called from 9E9D8        |
| sub_9A490+1   | Function table called from 9E9D8        |
| sub_9E1C4+1   | Function table called from 9E9D8        |
| sub_9C42C+1   | Function table called from 9E9D8        |

### Other Subs

No clue why do we have these. :)

| Sub Name      | Details |
|---------------|---------|
| sub_43B8C     |         
| sub_43B78     | Called in sub_43B8C     
| sub_43B30     | Called in sub_43B8C     
| sub_1B7E44    | Called in sub_43B8C     
|---------------|---------|
| sub_1B86EC    | Calls sub_19B6C4 with inline sum        |
| sub_19B6C4    | Called in sub_1B86EC    
|---------------|---------|
| sub_8742C     |         |

## Various Notes

  * ``_DWORD`` is 32bit (``uint32_t``); ``_QWORD`` is 64bit (``uint64_t``).

  * Type inference of the compiler may not be accurate.  For example,
    an (int) variable may as well in fact contain a pointer.
